# Relat√≥rio Scribe ‚Äî 2026-02-21

## ‚úÖ Resumo Executivo (curto)
- **WhatsApp (Channels):** MVP definido com **WPPConnect**; UI de Canais avan√ßada (status, QR, a√ß√µes).
- **Backend WhatsApp:** endpoints completos (status/connect/reconnect/disconnect/qrcode/webhook), persist√™ncia m√≠nima e fixes de webhook/status.
- **Atendimento:** pronto para avan√ßar com base no canal WhatsApp funcional; QA j√° existe.
- **Whatsmeow (m√©dio prazo):** submodule + helpers para bot√µes/listas/interactive; docs adicionadas.
- **Migra√ß√£o:** plano WPPConnect ‚Üí Whatsmeow em 2 fases, com rollback r√°pido.

**Pend√™ncias:** validar webhook real, E2E completo, homologa√ß√£o Whatsmeow, feature-flag + smoke test, alinhar runtime via deploy.

---

## üõ†Ô∏è Resumo T√©cnico (detalhado)
### 1) Frontend (Canais/WhatsApp)
- Estados: `disconnected`, `connecting`, `qr_pending`, `connected`, `error`.
- A√ß√µes: conectar/reconectar/desconectar/atualizar QR.
- UI: modal QR, metadados (n√∫mero, sess√£o, heartbeat), polling configur√°vel, provider-agnostic.

### 2) Backend (WPPConnect)
- Endpoints:
  - `GET /channels/whatsapp/status`
  - `POST /channels/whatsapp/connect`
  - `POST /channels/whatsapp/reconnect`
  - `POST /channels/whatsapp/disconnect`
  - `GET /channels/whatsapp/qrcode`
  - `POST /channels/whatsapp/webhook`
- Integra√ß√£o REST WPPConnect: `start/check/qrcode/logout`.
- Persist√™ncia: `whatsapp_sessions` + entity/repository + migration `1709000000000-CreateWhatsappSessions.ts`.
- Fixes: cast status webhook, parser real (`event/onmessage` + nested payload), status mapping ampliado, controller registrado (corrige 404), toler√¢ncia √† tabela ausente no seed.

### 3) Atendimento
- Direcionamento: evolu√ß√£o com base no canal WhatsApp operacional.
- QA existente continua como base.

### 4) Whatsmeow (estrat√©gia)
- Submodule `vendors/whatsmeow`.
- Helpers: buttons, list, nativeFlow (InteractiveMessage), valida√ß√µes/limites.
- Docs/changelog adicionados.

### 5) Migra√ß√£o
- Plano em 2 fases com feature flag, rollout gradual e rollback <2 min.
